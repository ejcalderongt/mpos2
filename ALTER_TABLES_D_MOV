ALTER TABLE D_MOV 
ALTER COLUMN RUTA INT NOT NULL
GO

ALTER TABLE D_MOV 
ALTER COLUMN USUARIO INT NOT NULL
GO

ALTER TABLE D_MOV 
ALTER COLUMN ANULADO BIT NOT NULL
GO

ALTER TABLE [dbo].[D_MOV]  WITH CHECK ADD  CONSTRAINT [FK_D_MOV_P_RUTA] FOREIGN KEY([RUTA])
REFERENCES [dbo].[P_RUTA] ([CODIGO_RUTA])
GO

ALTER TABLE D_MOV CHECK CONSTRAINT [FK_D_MOV_P_RUTA]
GO

ALTER TABLE D_MOV  WITH CHECK ADD  CONSTRAINT [FK_D_MOV_VENDEDORES] FOREIGN KEY([USUARIO])
REFERENCES VENDEDORES ([CODIGO_VENDEDOR])
GO

ALTER TABLE D_MOV CHECK CONSTRAINT [FK_D_MOV_VENDEDORES]
GO

ALTER TABLE D_MOVD DROP CONSTRAINT [PK_D_MOVD] WITH ( ONLINE = OFF )
GO

ALTER TABLE D_MOVD DROP CONSTRAINT [FK_D_MOVD_D_MOV]
GO

ALTER TABLE D_MOVD 
ALTER COLUMN PRODUCTO INT NOT NULL
GO

ALTER TABLE D_MOVD
ADD CORELDET INT IDENTITY(1,1) 

ALTER TABLE D_MOVD  WITH CHECK ADD  CONSTRAINT [FK_D_MOVD_P_PRODUCTO] FOREIGN KEY([PRODUCTO])
REFERENCES P_PRODUCTO ([CODIGO_PRODUCTO])
GO

ALTER TABLE D_MOVD CHECK CONSTRAINT [FK_D_MOVD_P_PRODUCTO]
GO

ALTER TABLE D_MOVD ADD  CONSTRAINT [PK_D_MOVD] PRIMARY KEY CLUSTERED 
(
	[CORELDET] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX [IX_D_MOVD] ON [dbo].[D_MOVD]
(
	[COREL] ASC,
	[PRODUCTO] ASC,
	[LOTE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO

ALTER TABLE D_MOV
ADD CODIGO_PROVEEDOR INT NOT NULL

ALTER TABLE D_MOV 
ADD TOTAL FLOAT NOT NULL

ALTER TABLE D_MOV  WITH CHECK ADD  CONSTRAINT [FK_D_MOV_P_PROVEEDOR] FOREIGN KEY([CODIGO_PROVEEDOR])
REFERENCES P_PROVEEDOR ([CODIGO_PROVEEDOR])
GO

ALTER TABLE D_MOV CHECK CONSTRAINT [FK_D_MOV_P_PROVEEDOR]
GO
ALTER TABLE D_MOVD 
ADD PRECIO FLOAT NOT NULL


